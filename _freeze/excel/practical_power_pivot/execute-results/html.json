{
  "hash": "cf88379111c195427e3b52b0bc08eba5",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Practical PowerPivot\"\ndate: \"2024-06-06\"\nexecute: \n  echo: true\n  freeze: auto\ncategories: [excel, intermediate]\n\n---\n\n::: {.cell layout-align=\"left\"}\nNo feedback found for this session\n:::\n\n\n## Welcome\n\n-   this session is [ðŸŒ¶ðŸŒ¶]{style=\"color:red;\"}, so it's designed for intermediate users with plenty of previous Excel PivotTable experience\n    -   [PowerPivot infrastructure varies widely](https://support.microsoft.com/en-gb/office/where-is-power-pivot-aa64e217-4b6e-410b-8337-20b87e1c2a4b), so we can't advise on installation\n-   if you can't access the chat, you might need to join our Teams channel: **tinyurl.com/kindnetwork**\n\n## Session outline\n\n-   check that you have Power Pivot please!\n-   find and tidy some data\n-   add to Power Pivot\n-   play with data in Power Pivot\n\n## Word of warning\n\n-   Power Pivot in Excel is still officially supported, but has been largely replaced by Power BI\n    -   I'd be circumspect about its long-term prospects\n    -   I'd also be cautious about starting more ambitious projects in Power Pivot - lots of glitches, few fixes\n\n## Nutshell\n\n-   PowerPivot = effectively a [local SSAS](https://learn.microsoft.com/en-us/analysis-services/ssas-overview?view=asallproducts-allversions)\n-   that means PowerPivot allows you to do fancy relational work with your data\n-   it *can* also means higher performance with large (10k rows +) data\n-   yet allows you to use Excel for data ingest and output\n\n## Data\n\n-   download the [Agatha Christie dataset](https://docs.google.com/spreadsheets/d/1A8ZRe5KLLAllhT31pCzke4j5qAPqeMKf0jYgyJXcoPs/edit#gid=564606948) as an Excel file\n-   tidying:\n    -   remove filters\n    -   create 4 x named tables\n    -   standardising titles if you're highly conscientious\n\n## Add data to Power Pivot\n\n-   find Power Pivot\n-   add to data model x 4\n-   diagram view and create relationships\n\n## DAX intro\n\n-   similar to, but larger, than Excel formula language\n-   structured references - so `table[column]`\n-   no referencing individual cells/random ranges\n-   ability to write expressions that update in Pivot Tables\n\n## Make a Pivot Table\n\n-   this should feel nice and familiar - with the option of bringing together several tables of data</br> ![](images/clipboard-3398167195.png){height=\"300px\"}![](images/clipboard-1733713359.png){height=\"300px\"}\n\n## Make a new column\n\n-   `= all_titles[Year of first publication] - 1`\n-   rename, return to your Pivot table, and ruin the years...\n\n## Relationships\n\n-   you can create relationships between different parts of your data, and exploit those relationships using DAX\n-   open the diagram view, and connect the `Title ID` columns together</br>![](images/clipboard-4256752901.png){height=\"400px\"}\n\n## Relationships have directions\n\n(with thanks to Michael Robb, NHS Highland)\n\n![](images/clipboard-823580961.png)\n\n## Fancier calculated column\n(with thanks to Michael Roarty, NHS NSS)\n\n-   add a series col to your all_titles data\n    -   `=related(novels[Series]) & related(short_stories[Series])`\n-   add a year of publication col to your short_story data\n    -   `=LOOKUPVALUE(ssc[Year of first publication], ssc[Title Name], short_stories[Collection])`\n-   add a rounded year\n    -   `= MROUND([Year of first publication], 5)`\n\n## Back to your pivot table\n\n## Chat, queries, questions\n\n-   Teams channel: **tinyurl.com/kindnetwork**\n-   weekly email update: **tinyurl.com/kindupdate**\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}