{
  "hash": "7660e98a083e279f2c7ab4f888e5df18",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lambda formulas in Excel\"\ndate: \"2024-07-15\"\nexecute: \n  echo: false\n  freeze: auto\ncategories: [excel, intermediate]\n---\n\n:::{.callout-note collapse=false appearance='default' icon=true}\n## Session materials\n+ [all materials {{< iconify ph:file-zip size=2x >}}](src/lambda_formulas_in_excel.zip)\n+ slides [{{< iconify ph:file-html size=2x >}} html](src/lambda_formulas_in_excel.html) / [{{< iconify ph:file-pdf size=2x >}} pdf](src/lambda_formulas_in_excel.pdf)\n:::\n\n\n::: {.cell layout-align=\"left\"}\nNo feedback found for this session\n:::\n\n\n## Welcome\n\n-   ðŸŒ¶ðŸŒ¶ this session is for intermediate Excel users\n-   you'll **need** M365 Excel (either web or desktop) to follow along\n    -   earlier versions of Excel don't have the `LAMBDA` function that we'll need\n    -   you'll also need to be pretty fluent with formulas, and know a bit about naming things in Excel\n\n## Session outline\n\n-   this session is based on our [Excel skill-builder](https://learn.nes.nhs.scot/71690) course\n-   quick introduction to lambda formulas\n-   `LAMBDA()`\n-   two practical examples\n-   use-cases, and tips for applications\n\n## Introduction\n\n-   lambda formulas are a way of repeating complicated Excel formulas safely\n-   fairly new - M365 Excel only\n-   odd, rather than hard to implement\n\n## `LAMBDA`\n\n![Microsoft's summary of LAMBDA](https://support.content.office.net/en-us/media/627806f0-40f4-4a27-86d1-4ef77a86331c.png)</br>\n\n1.  take an existing formula\n2.  work out what the inputs are - usually, which cells are referenced\n3.  add one parameter per input\n4.  do a calculation with those parameters\n5.  name and save that formula\n\n## Making a lambda function (setup)\n\n-   put some random numbers in `A3` and `B3`\n-   we could calculate `A3` \\* `B3` directly\n-   but imagine we want to convert `= A3 * B3` to a lambda\n\n## Making a lambda function\n\n-   start with the lambda outline in `D3`\n    -   `= LAMBDA()`\n-   next, add **test values in a second set of brackets**\n    -   `= LAMBDA()(A3, B3)`\n-   we now invent parameter names (like variable names) for each of those values, and add them\n    -   `= LAMBDA(n_1, n_2, )(A3, B3)`\n-   then add the formula that we want to replicate\n    -   `= LAMBDA(n_1, n_2, n_1 * n_2)(A3, B3)`\n\n## Saving a lambda function\n\n-   once you've tested and checked your lambda with a range of test values, copy your lambda formula (without the test values in the second brackets)\n-   then open the name manager (`Ctrl` + `F3`)\n-   create a new name, then name your lambda definition using the **New Name** interface\n-   paste your lambda into the **Refers to:** section\n    -   omit the test values - so just `= LAMBDA(n_1, n_2, n_1 * n_2)`\n-   test your new lambda function\n\n## Lambda functions\n\n-   a real-ish example: converting [CHI](https://en.wikipedia.org/wiki/National_Health_Service_Central_Register) to DoB\n-   put an example CHI into G2 (like `1610790854`)\n-   you can use the following ðŸ˜± formula:\n\n\n\n```{.default}\n=DATE(IF(RIGHT(LEFT(G2, 6), 2) > RIGHT(YEAR(TODAY()), 2), 19, 20) & RIGHT(LEFT(G2, 6), 2), MID(LEFT(G2, 6), 3, 2), LEFT(LEFT(G2, 6), 2))\n\n```\n\n\n\n-   that's a horrifying thing to paste about, so we can make this into a lambda:\n\n\n\n```{.default}\n=LAMBDA(chi, DATE(IF(RIGHT(LEFT(chi, 6), 2) > RIGHT(YEAR(TODAY()), 2), 19, 20)&RIGHT(LEFT(chi, 6), 2), MID(LEFT(chi, 6), 3, 2), LEFT(LEFT(chi, 6), 2)))(G2)\n\n```\n\n\n-   then save as `CHI_TO_DOB` via the name manager\n\n\n## Use-cases, and tips for applications\n\n-   making workbooks less complicated\n    -   names and lambda formulas are a strong combo\n-   standardising (and user-proofing) complex formulas\n-   lambdas are local, so you need to think laterally to re-use them\n    -   make a new blank sheet, and right-click the sheet tab\n    -   `Move or Copy...` to new book </br>![](images/clipboard-251116894.png){height=\"200px\"}\n",
    "supporting": [
      "lambda_formulas_in_excel_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}