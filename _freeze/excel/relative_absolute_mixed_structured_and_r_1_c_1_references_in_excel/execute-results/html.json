{
  "hash": "6e696a676a8ef2e151b6d01eaffab780",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Relative, absolute, mixed, and structured references\"\ndate: \"2024-08-08\"\nexecute: \n  echo: true\n  freeze: auto\ncategories: [excel, intermediate]\n---\n\n\n\n::: {.callout-note collapse=\"false\" appearance=\"default\" icon=\"true\"}\n## Session materials\n\n-   [all materials {{< iconify ph:file-zip size=2x >}}](src/excel_references.zip)\n-   slides [{{< iconify ph:file-html size=2x >}} html](src/excel_references.html) / [{{< iconify ph:file-pdf size=2x >}} pdf](src/excel_references.pdf)\n+ exercises [{{< iconify ph:file-xls size=2x >}}.xlsx](src/excel_references.xlsx) / completed exercises [{{< iconify ph:file-xls size=2x >}}.xlsx](src/excel_references_completed.xlsx)\n:::\n\n\n\n::: {.cell layout-align=\"left\"}\n  \n## Previous attendees have said...  \n  \n- 9 previous attendees have left feedback\n- 100% would recommend this session to a colleague\n- 100% said that this session was pitched correctly  \n\n  \n![](relative_absolute_mixed_structured_and_r_1_c_1_references_in_excel_files/figure-html/unnamed-chunk-1-1.png){fig-align='left' width=288}  \n  \n:::{.callout-note}  \n### Three random comments from previous attendees  \n- I could already do some of what was discussed but the session gave me a better understanding of where to use it and how the formulae work\n- even as an Excel old hat I still always discover something new on these sessions\n- I missed the first 20 minutes as I was tied up in another meeting, but found what I did attend useful, thank you\n  \n:::  \n:::\n\n\n\n\n## Welcome\n\n+ this session is for ðŸŒ¶ðŸŒ¶ intermediate Excel users\n+ you' need Excel of some sort to follow along\n+ you'll also need the [exercise workbook](src/excel_references.xlsx)\n+ if you can't access the chat, you might need to join our Teams channel: [tinyurl.com/kindnetwork](https://teams.microsoft.com/l/team/19%3AQZ7-PbFVcziG2piHLt1_ifey3I2cwFL0yBuTSS8vVao1%40thread.tacv2/conversations?groupId=106d08f3-9026-40e2-b3c7-87cd87304d58&tenantId=10efe0bd-a030-4bca-809c-b5e6745e499a)\n+ you can find session materials at [tinyurl.com/kindtrp](https://nes-dew.github.io/KIND-training/)\n\n## Session outline\n+ this is an intermediate-level review of referencing techniques in Excel\n+ it's a technical session, so we'll concentrate on the how of referencing\n+ A1 references\n    + relative\n    + absolute\n    + mixed\n+ structured references\n+ R1C1\n\n## A1 references\n\n+ A1 references are the standard way that references are made in Excel\n+ A1 references are usually made up of a letter and a number (like **A2**, **B56**, ...)\n    + the letter stands for the column a cell is in\n    + the number stands for the row\n+ we can use those references in formulas\n  + `=A1` will copy the values from A1 into the current cell\n+ you can also use the `range operator` (`:`) to select several values - like `A1:A3`\n\n::: {.callout-tip title=\"Task\"}\n1. using A1 references, can you populate the first three rows of the summary table in the `A1 referencing` sheet? </br>![](images/ref_task.png)\n    a. Start date\n    b. End date\n    c. First duty manager\n1. you might need to switch off **Calculated Columns** from the floatie </br>![](images/01_stop_calc.png)\n:::\n\n### Absolute vs relative references\n\n+ by default, A1 references are **relative**\n  + if the formula moves, the reference will change\n\n::: {.callout-tip title=\"Task\"}\n1. try copy/pasting your three summary values:\n    1. a few columns across\n    1. a few rows down\n1. what happens to your values?\n:::\n\n![The effect of moving our summary cells down the sheet](images/refs.png){height=\"200\"}\n\n+ as you've seen, relative references can cause problems\n+ you can change relative references to absolute (=fixed) references using `$`\n  + `$A$1` refers to A1 **no matter what**\n    + use this if you absolutely always want to refer to the same cell\n\n::: {.callout-tip title=\"Task\"}\n1. update your relative references in the summary table to absolute references by adding `$` before both the column letter, and the row number\n:::\n\n::: {.callout-note}\n+ if you click in the formula bar, `F4` toggles absolute/relative\n:::\n\n### Mixed references\n\n+ `$A1` will be absolute in the column, but relative in the rows\n+ `A$1` will be relative in the row, but absolute in the column\n+ take care with these - they're pretty confusing (and we'll look at a much better way of doing the same thing below)\n\n\n## Structured referencing\n+ most objects in Excel can be named - including cells, tables, and ranges\n+ structured referencing is a special case\n    + `Table[Column]` syntax\n    + shared across Power BI, PowerQuery...\n\n\n\n::: {.callout-tip title=\"Task\"}\n1. please switch to the `Structured referencing` sheet\n1. sum up each of the three service columns in the summary table\n- `=SUM(SR_table[service_a])` / `=SUM(SR_table[service_b])` / `=SUM(SR_table[service_c])`\n:::    \n    \n### Implicit intersection\n+ you can convert a structured reference to a column to refer to a single value\n+ that's done using the [**implicit intersection** operator](https://support.microsoft.com/en-gb/office/implicit-intersection-operator-ce3be07b-0101-4450-a24e-c1c999be2b34) `[@col]`\n    + (if you're using an older version of Excel, you might also see this written as `[@[Service_duration]]`)\n+ if you pick reference locations with the mouse, this is how Excel will render your references\n\n\n\n::: {.callout-tip title=\"Task\"}\n1. please try populating the `daily_total` by summing with implicit intersection\n- `=SUM(SR_table[@[service_a]:[service_c]])`\n:::   \n\n## R1C1\n+ R1C1 gives an alternative way of referring to cells\n+ slightly more complicated, but more precise, and less confusing\n+ largely encountered in VBA, but available and helpful in standard Excel\n\n::: {.callout-tip title=\"Task\"}\n1. Switch to the `R1C1 referencing` sheet\n1. switch to inspect formulas (`Ctrl` + backtick)\n1. Have a look at the formula in the `First name` column\n1. Now switch your workbook to R1C1 by `File` > `Options` > `Formulas` > `R1C1 reference style` </br>![](images/04_r1c1.png)\n:::\n\n+ column letters (A, B, C,â€¦) are replaced by numbers\n+ row numbers remain as row numbers\n    + R1C1 = A1\n    + R2C8 = H2\n\n\n\n::: {.callout-tip title=\"Task\"}\n1. Have another look at the formula in the `First name` column - it should be much easier to conclude that this is the same formula in every row\n:::\n\n### Types of R1C1 referencing\n\n+ three kinds of R1C1 reference:\n    + absolute reference  = specify a row and column number (`R2C2`)\n    + relative reference by adding a numeric offset in square brackets (`R2C[-6]`)\n    + implicit intersection-like \"give me this row's column 2\" by using a bare R/C (`RC2`)\n+ a much nicer way of doing mixed referencing\n\n\n\n::: {.callout-tip title=\"Task\"}\n1. in R16C4, please populate the four rows of the `Age` column in the summary table using R1C1\n:::\n\n\n### Why bother with R1C1?\n+ R1C1 adds a bit of complexity to simple formulas\n  + but it makes complicated formulas (and repeated formulas) **much** easier to understand\n  + this is a big help when working with more complex Excel documents - particularly if you're debugging something that's gone wrong\n+ R1C1 gives the same formulas for the same work across different columns\n  + we have to work this out by hand with A1 referencing - the row number would be different each time\n  + this helps us understand quickly when and where a formula is repeated\n+ (apparently) R1C1 is faster with very complex sheets",
    "supporting": [
      "relative_absolute_mixed_structured_and_r_1_c_1_references_in_excel_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}