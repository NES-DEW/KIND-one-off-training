{
  "hash": "4e5586ff3006877d89642bf285f0e014",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Tidy data in Excel\"\nexecute: \n  echo: false\n  freeze: auto\ncategories: [excel, beginner]\n---\n\n::: {.cell layout-align=\"left\"}\n  \n## Previous attendees have said...  \n  \n- 19 previous attendees have left feedback\n- 95% would recommend this session to a colleague\n- 100% said that this session was pitched correctly  \n\n  \n![](tidy_data_in_excel_files/figure-html/unnamed-chunk-1-1.png){fig-align='left' width=288}  \n  \n:::{.callout-note}  \n### Three random comments from previous attendees  \n- Enjoyed this today - learned a few new tips'n'tricks! There's alwasy somehting you pickup even when you think you know the topic.  - 'Text to columns' skip column functionality  - Data Validation Use Case and Circles  - Excel 'Float' menu keyboard interaction\n- Good session picked up some really good tips. Sometime presenter goes a bit fast for those following and trying to replicate actions being taken in spreadsheet\n- As a self taught user of Excel it's always good to find out about different ways of doing things, this was a good back to basics and reminder of best practice.\n  \n:::  \n:::\n\n\n\n## Welcome\n\n-   this session is for ðŸŒ¶ Excel beginners\n-   this is a mainly-practical session, and you'll need Excel of some sort to follow along\n- download [slides](src/tidy_data_excel.html), [pdf slides](src/tidy_data_excel.pdf), and the [sample Excel workbook](src/tidy_data_excel.xlsx) for this session\n\n## Where does this fit in?\n\n![KIND Excel beginner skill tree](images/clipboard-3911010684.png)\n\n-   for this session, you'll need to be familiar with the Excel basics (getting around in Excel, opening/saving/closing files, and a little bit of A1 referencing)\n-   we're going to dodge formatting and formulas as much as possible today\n\n## Session outline\n\n-   understanding tidy data\n-   a word of warning\n-   a practical introduction to making tidy data:\n    -   values\n    -   tables\n    -   autofill\n-   exercises and demos\n\n## Understanding tidy data\n\n![R4DS Figure 5.1: The following three rules make a dataset tidy: variables are columns, observations are rows, and values are cells, via CC BY-NC-ND 3.0 US](images/clipboard-3584154739.png)\n\n-   tidy data is not specific to Excel (e.g. this session is partly adapted from [chapter 5 of R for Data Science](https://r4ds.hadley.nz/data-tidy))\n-   if we tidy our data, we'll be able to compute it\n-   standards for tidying data help make for safe and effective analysis\n\n## A word of warning\n\n-   tidying data can be very slow and complicated\n-   in Excel, there are lots of advanced tools that can speed things up\n    -   PowerQuery especially\n-   this is a beginner's session, so we'll avoid the more fancy tools\n-   **but** if your process takes lots of manual work, it's definitely worth exploring alternative ways of working\n\n## Values\n\n-   `values` is the word we use to describe each bit of information in an Excel spreadsheet. Some examples:\n    -   a date, like `2024-06-28`\n    -   a number, like `11.2`\n    -   a name, like `NHS Grampian`\n    -   a cost, like `Â£12.50`\n    -   ...\n-   each value should have its own cell\n\n## Entering values\n\n-   how would you enter this data: `2018, 2019, 2020, 2021, 2022`?\n-   please now:\n    -   open Excel\n    -   start a new workbook\n    -   add a column header `year` in cell `A1`\n    -   then add each of those five values in the five cells underneath (down to `A6`)\n\n## More values\n\n-   we're going to be using some [birthrate data from the NRS](https://www.nrscotland.gov.uk/statistics-and-data/statistics/statistics-by-theme/vital-events/general-publications/vital-events-reference-tables/2022) for this session. We'll start by adding some birth rate data\n\n-   this is given as births per 1,000 women in five year age brackets. We'll start with 25-29 year old mothers\n\n-   please add the header `25-29yrs` in cell `B1`\n\n-   here are the values for our five years: `73.4, 71, 66.8, 69.6, 66.7`\n\n## Tables\n\n-   you should keep your new data in a **table**\n-   `Insert` \\> `Table` </br> ![Or you might prefer the Ctrl + T shortcut](images/clipboard-3262660351.png)\n-   tables allow you to sort and filter your data\n-   they also act as a useful 'container' (or **data structure**) for your data\n\n## Extending tables\n\n| 30-34yrs |\n|----------|\n| 90.9     |\n| 88.6     |\n| 83.4     |\n| 85.9     |\n| 84.4     |\n\n-   please could you add some new data to your table showing births for another age group\n-   you should be able to drag the blue table corner over your new column to extend the table </br>![blue table corner](images/clipboard-99329456.png)\n\n## Autofill\n\n-   one last way of adding values: autofill\n-   drag again to make a new empty column, and label it `difference`\n-   in `D2` (the first 'proper' cell), copy this formula: `=C2-B2`. This will calculate the difference in birth rates between the two columns\n-   finally, click the small green corner of that newly-filled cell to autofill the column ![small green corner](images/clipboard-1736118371.png)\n\n## Back to tidy data\n\n-   we've now got some data with:\n    -   each value in a cell\n    -   each variable in a column\n        -   here, this is a maternal age bracket\n    -   each observation in a row\n        -   here, this is a year\n-   we could work through and extend this data by hand, but we'll now switch over to some supplied data to save all the typing\n    -   errors are common in manual data-entry\n    -   if you can import data, that's usually better than re-typing it\n\n## Many values per cell\n\n-   We often find useful data with more than one value per cell\n-   this can be helpful for humans </br> ![multiple values is good for humans, but bad for Excel](images/clipboard-1363924537.png)\n-   Excel can't do anything with this data\n\n## Exercise one: many values per cell\n\n-   find the `Exercise one` sheet in the exercise file\n-   try calculating an average for each of the groups\n-   or, if you're more confident, try plotting the data\n\n## Nothing works!\n\n![Divide by zero errors in the averages](images/clipboard-2726354511.png) </br> ![Plots produce pure nonsense](images/clipboard-945883446.png)\n\n## What's the solution?\n\n-   make this data have **one value per cell**\n-   we could remove all the percentages by hand - but that's going to be very slow\n-   `Text to Columns` gives us a better tool for the job </br> ![Text to Columns gives us a better tool for the job](images/clipboard-3594403318.png)\n\n## Text to Columns\n\n-   select a column\n-   in the `Data` tab of the ribbon, you should find the `Text to Columns` tool </br> ![Text to Columns tool](images/clipboard-3002655192.png)\n-   note that you can keep, or remove, the percentage column. We'll **skip** it, to keep things simple </br> ![keep, or remove, the percentage column](images/clipboard-4061284093.png)\n\n## Try working with that data again\n\n![We can plot the data now](images/clipboard-3377421044.png)\n\n## Exercise two: transposed data\n\n-   sometimes you'll find data where the columns and rows have been flipped </br> ![data where the columns and rows have been flipped](images/clipboard-2760486038.png)\n-   that's slow to fix by hand, but luckily you can **transpose it**, which swaps rows and columns\n-   select your data, and copy/paste into a new cell\n-   then use the transpose option <br>![transpose option](images/clipboard-3580893754.png)\n\n## Exercise two: transposed data\n\n-   you might need to fix formatting and labels: ![fix formatting and labels](images/clipboard-3017525992.png) </br>\n-   the `Clear formats` option might help this ![Clear formats](images/clipboard-2927420900.png)\n-   if you run into trouble, please note that transposing only works on data [that is not in a table](https://support.microsoft.com/en-gb/office/transpose-rotate-data-from-rows-to-columns-or-vice-versa-3419f2e3-beab-4318-aae5-d0f862209744)\n\n## Demo one: validation and really messy data\n\n-   one of the most time-consuming bits of tidying is checking your values\n-   we'll briefly demonstrate the **data validation** tool </br> ![the data validation tool](images/clipboard-622908428.png)\n-   this allows you to describe what format you think your data should be in, and then highlights anything that doesn't fit\n\n## Demo one: validation and really messy data\n\n-   we select the `years` column\n-   then open the data validation tool\n-   then set appropriate validation options, so **Whole number** between 2010 and 2030 </br> ![set appropriate validation options](images/clipboard-665473732.png)\n\n## Demo one: validation and really messy data\n\n-   then select `Circle Invalid Data` </br> ![select Circle Invalid Data](images/clipboard-1528491886.png)\n-   we can now go through and fix anything circled\n\n## Demo two: reshaped data\n\n-   there are several ways of reshaping data that's not in a tidy format\n-   we'll look at the manual way here, but - as it's horrible - I'd be keen to encourage you to investigate Power Query or Pivot Tables to reshape if this is a regular part of your working day. PQ takes \\< 10 seconds, PT not much longer\n\n## Manual reshape\n\n-   sort the data by year </br>![sort the data by year](images/clipboard-3321721696.png)\n-   then copy and paste blocks of data, making sure to keep the years aligned </br>![copy and paste blocks of data](images/clipboard-2841186181.png)\n\n## Manual reshape\n-   make sure you then copy the age brackets to label the column </br>![copy the age brackets to label](images/clipboard-1151172294.png)\n-   then delete the spare years columns, and the age brackets </br>![delete the spare years](images/clipboard-1265051366.png)\n\n",
    "supporting": [
      "tidy_data_in_excel_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}