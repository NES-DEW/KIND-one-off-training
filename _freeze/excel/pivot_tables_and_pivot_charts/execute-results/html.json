{
  "hash": "3408e8c71a22fe44d96fe6cc36a2ce0b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Pivot tables and pivot charts\"\ndate: \"2024-06-13\"\nexecute: \n  echo: false\n  freeze: auto\ncategories: [excel, intermediate]\n---\n\n::: {.cell layout-align=\"left\"}\n  \n## Previous attendees have said...  \n  \n- 21 previous attendees have left feedback\n- 100% would recommend this session to a colleague\n- 95% said that this session was pitched correctly  \n\n  \n![](pivot_tables_and_pivot_charts_files/figure-html/unnamed-chunk-1-1.png){fig-align='left' width=288}  \n  \n:::{.callout-note}  \n### Three random comments from previous attendees  \n- Seemed rushed - make the sessions longer perhaps or breakdown into more manageable chunks. Session order seems strange i.e. beginner sessions after intermediate - perhaps that's an issue of when I found out about the KIND Network.\n- Well presented and lots of little tips to expand my skills using excel\n- I am glad that I am able to attend this sessions.\n  \n:::  \n:::\n\n\n\n## Welcome!\n\n+ this session is for üå∂Ô∏èüå∂Ô∏èintermediate Excel users\n+ we'll do an initial chat and run through, followed by a practical demo\n    + you're welcome to stay for all or part of the session\n+ if you want to follow the practical part, you'll need:\n    + Excel, ideally M365 Desktop\n    + previous Excel experience (particularly around references, tables, and formulas)\n    + the data: [guidance](https://publichealthscotland.scot/publications/nhs-waiting-times-18-weeks-referral-to-treatment/nhs-waiting-times-18-weeks-referral-to-treatment-quarter-ending-31-december-2023/) / [download page](https://www.opendata.nhs.scot/dataset/18-weeks-referral-to-treatment) / [direct](https://www.opendata.nhs.scot/dataset/aa8b22e8-8a02-484d-a6c8-0a0154a6249d/resource/f2598c24-bf00-4171-b7ef-a469bbacbf6c/download/open_data_18_weeks_rtt.csv) / short **tinyurl.com/kinddata1**\n+ it also helps if you have access to the chat. You may need to add youself to the KIND Network Teams channel: **tinyurl.com/kindnetwork**\n\n\n## Session outline\n\n+ Pivot tables\n+ Pivot charts\n+ Slicers\n+ the session is totally informal\n  + cameras on, please\n  + chat/question away\n  + don't panic if things go wrong\n\n## Why pivot tables?\n\n-   **the** key summary tool in Excel\n-   we often want to summarise long/complex data\n-   two key concerns:\n    -   we want to do that safely\n    -   we also want to do that effectively\n-   pivot tables are safe and effective\n    -   they keep your analysis out of your data\n    -   they have lots of powerful tools built-in\n\n## Some data\n\n1.  on the [18 week referral target](https://opendata.scot/datasets/public+health+scotland-18+weeks+referral+to+treatment/)\n2.  Copy the [data link](https://www.opendata.nhs.scot/dataset/aa8b22e8-8a02-484d-a6c8-0a0154a6249d/resource/f2598c24-bf00-4171-b7ef-a469bbacbf6c/download/open_data_18_weeks_rtt.csv)\n3.  Open the **Get Data From web** tool </br> ![](images/clipboard-1578174090.png)\n4.  Paste in the link </br> ![](images/clipboard-1582667377.png)\n\n## What questions might we ask about that data?\n\n## Insert a pivot table\n\n-   on a new sheet</br> ![](images/clipboard-1899219137.png)\n-   `ALT`, `N`, `V`, `T`\n\n## Adding data to a pivot table\n\n::: columns\n::: {.column width=\"30%\"}\n![](images/pt_cols.png){height=\"500\"}\n:::\n\n::: {.column width=\"5%\"}\n<!-- empty column to create gap -->\n:::\n\n::: {.column width=\"65%\"}\n-   we build pivot tables from the fields interface\n:::\n:::\n\n## Adding data to a pivot table\n\n::: columns\n::: {.column width=\"30%\"}\n![](images/pt_cols_p.png){height=\"500\"}\n:::\n\n::: {.column width=\"5%\"}\n<!-- empty column to create gap -->\n:::\n\n::: {.column width=\"65%\"}\n-   drag values to fields\n-   dropdowns change settings\n:::\n:::\n\n## Improving our pivot table\n\n![](images/clipboard-1128103846.png){height=\"300\"}\n\n-   that gives us a simple pivot table\n-   we can also add a PivotChart instantly - click on your pivot table, and press `Alt + F1`\n    -   play with the expansion buttons - the PivotChart should update to reflect the way that your PivotTable is currently arranged\n\n## PivotTable warnings\n\n-   this isn't Excel!\n-   warnings about coherence\n\n## PivotTable tips\n\n::: callout-note\n-   Double-click any cell in a PivotTable to see the underlying data\n-   Group PivotTable items using:\n    -   `Shift` + `Alt` + `‚Üí` (right arrow) to add items to a group\n    -   `Shift` + `Alt` + `‚Üê` (left arrow) to ungroup\n-   Add a new calculated field using `Ctrl` + `Shift` + `=` (equals)\n-   Delete an entire PivotTable using `Ctrl + A` then pressing `Del`\n:::\n\n## Add board names\n\n-   those codes are hard work\n-   let's make them [look a little more human](https://www.opendata.nhs.scot/dataset/geography-codes-and-labels/resource/652ff726-e676-4a20-abda-435b98dd7bdc)\n-   [board names data](https://www.opendata.nhs.scot/datastore/dump/652ff726-e676-4a20-abda-435b98dd7bdc?bom=True)\n\n## Years and months\n\n-   our Month column is a pain\n-   we can turn that back into a proper date\n-   `=date(left([@Month], 4), right([@Month], 2), 24)`\n-   refresh the pivot table, and update the fields\n\n## PivotTable pages\n\n-   we can split out parts of a PivotTable to separate worksheets\n\n::: {.callout-tip title=\"Task\"}\n1.  Drag the Years item to the *Filters* field. This should update the PivotTable so that only one year's data is present at once\n2.  We can also split each year into its own worksheet: find the option in the PivotTable Analyze section of the ribbon - or via `Alt`, `J`, `T`, `T`, `P` </br>![](images/05_jttp.png)\n:::\n\n## Slicing\n\n-   one slicer can control many PivotTables\n\n::: {.callout-tip title=\"Task\"}\n1.  Click within one of your new annual PivotTables\n2.  Add a slicer from the insert menu (or `ALT`, `N`, `S`, `F`)\n3.  Select date to slice on\n4.  When the slicer appears, right click and select \"Report Connections...\" and add the other annual PivotTables\n5.  Now select a couple of months from your slicer, and see the effect on your PivotTables\n:::\n\n-   if you're working with dates, you can also use the timeline, which works in exactly the same way. Insert with `ALT`, `N`, `S`, `T`, update the connections, and you can get fine-grained control over which date-ranges contribute to your PivotTable\n",
    "supporting": [
      "pivot_tables_and_pivot_charts_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}