{
  "hash": "ca8b31f8c31fedd48a2277f6b541e4ec",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Scope of the possible with R\"\nexecute:\n    echo: true\n    freeze: auto\ncategories: [R, overview]\n---\n\n\n\n\n:::{.callout-note collapse=false appearance='default' icon=true}\n## Session materials\n+ [all materials {{< iconify ph:file-zip size=2x >}}](src/scope_of_the_possible_with_r.zip)\n+ slides [{{< iconify ph:file-html size=2x >}} html](src/scope_of_the_possible_with_r.html) / [{{< iconify ph:file-pdf size=2x >}} pdf](src/scope_of_the_possible_with_r.pdf)\n:::\n\n\n[Slides for this session](src/scope_of_the_possible_with_r.html) / [.pdf slides for this session](src/scope_of_the_possible_with_r.pdf)\n\n\n\n\n::: {.cell layout-align=\"left\"}\nNo feedback found for this session\n:::\n\n\n\n\n## Welcome\n\n-   this session is a **non-technical overview** designed for service leads\n\n## Session outline\n\n-   Why R, and why this session?\n-   R demo - take some data, load, tidy, analyse\n-   Strengths and weaknesses\n    -   obvious\n    -   less obvious\n-   Alternatives\n-   Skill development\n\n## R\n\n-   free and open-source\n-   multi-platform\n-   large user base\n-   prominent in health, industry, biosciences\n\n## Why this session?\n\n-   R can be confusing\n    -   it's code-based, and most of us don't have much code experience\n    -   it's used for some inherently complicated tasks\n    -   it's a big product with lots of add-ons and oddities\n-   But R is probably the best general-purpose toolbox we have for data work at present\n    -   big user base in health and social care\n    -   focus on health and care-like applications\n    -   not *that* hard to learn\n    -   extensible and flexible\n    -   capable of enterprise-y, fancy uses\n\n## R demo\n\n-   this is about showing what's possible, and give you a flavour of how R works\n-   we won't explain code in detail during this session\n-   using [live open data](https://www.opendata.nhs.scot/dataset/weekly-accident-and-emergency-activity-and-waiting-times) </br> ![https://www.opendata.nhs.scot/dataset/weekly-accident-and-emergency-activity-and-waiting-times](images/clipboard-776150275.png)\n\n## Load that data\n\n\n\n\n\n```{.r .cell-code}\nlibrary(readr)\nae_activity <- read_csv(\"data/weekly_ae_activity_20240609.csv\")\n```\n\n\n\n\n## One small bit of cheating: renaming\n\n\n\n\n\n```{.r .cell-code}\nnames(ae_activity) <- c(\"date\", \"country\", \"hb\", \"loc\", \"type\", \"attend\", \"n_within\", \"n_4\", \"perc_4\", \"n_8\", \"perc_8\", \"n_12\", \"perc_12\")\n```\n\n\n\n\n## Preview\n\n\n\n\n\nTable: Preview of data\n\n|     date|country   |hb        |loc   |type                 | attend| n_within|  n_4| perc_4| n_8| perc_8| n_12| perc_12|\n|--------:|:---------|:---------|:-----|:--------------------|------:|--------:|----:|------:|---:|------:|----:|-------:|\n| 20220109|S92000003 |S08000024 |S319H |Emergency Department |    733|      695|   38|   94.8|   1|    0.1|    0|     0.0|\n| 20240310|S92000003 |S08000024 |S314H |Emergency Department |   2273|     1078| 1195|   47.4| 384|   16.9|  177|     7.8|\n| 20170611|S92000003 |S08000024 |S314H |Emergency Department |   2265|     2181|   84|   96.3|   7|    0.3|    1|     0.0|\n| 20190310|S92000003 |S08000028 |W107H |Emergency Department |    120|      118|    2|   98.3|   0|    0.0|    0|     0.0|\n| 20180617|S92000003 |S08000022 |H212H |Emergency Department |    246|      235|   11|   95.5|   0|    0.0|    0|     0.0|\n\n\n\n\n## Removing data\n\n\n\n\n\n```{.r .cell-code}\nae_activity <- ae_activity |>\n    select(!c(country, contains(\"perc_\")))\n```\n\n\nTable: Preview of data\n\n|     date|hb        |loc   |type                 | attend| n_within| n_4| n_8| n_12|\n|--------:|:---------|:-----|:--------------------|------:|--------:|---:|---:|----:|\n| 20210502|S08000020 |N101H |Emergency Department |    904|      752| 152|  14|    1|\n| 20230115|S08000022 |C121H |Emergency Department |    138|      129|   9|   0|    0|\n| 20220313|S08000032 |L302H |Emergency Department |   1198|      744| 454|  87|   41|\n| 20240414|S08000016 |B120H |Emergency Department |    584|      364| 220|  63|   39|\n| 20240114|S08000031 |G513H |Emergency Department |   1295|     1235|  60|   0|    0|\n\n\n\n\n## Tidying data\n\n\n\n\n\n```{.r .cell-code}\nae_activity <- ae_activity |>\n    mutate(date = lubridate::ymd(date))\n```\n\n\nTable: Preview of data\n\n|date       |hb        |loc   |type                 | attend| n_within| n_4| n_8| n_12|\n|:----------|:---------|:-----|:--------------------|------:|--------:|---:|---:|----:|\n|2024-01-28 |S08000025 |R103H |Emergency Department |    126|      117|   9|   0|    0|\n|2021-02-21 |S08000024 |S308H |Emergency Department |    831|      667| 164|  41|    7|\n|2020-12-13 |S08000028 |W107H |Emergency Department |     70|       68|   2|   0|    0|\n|2021-05-16 |S08000032 |L106H |Emergency Department |   1412|     1216| 196|  25|    5|\n|2020-01-19 |S08000031 |G513H |Emergency Department |   1197|     1177|  20|   0|    0|\n\n\n\n\n## Subset data\n\n-   we'll take a random selection of 5 health boards to keep things tidy\n\n\n\n\n\n\n\n```{.r .cell-code}\nae_activity <- ae_activity |>\n    filter(hb %in% boards)\n```\n\n\nTable: Preview of data\n\n|date       |hb        |loc   |type                 | attend| n_within| n_4| n_8| n_12|\n|:----------|:---------|:-----|:--------------------|------:|--------:|---:|---:|----:|\n|2022-10-23 |S08000019 |V217H |Emergency Department |   1099|      409| 690| 379|  211|\n|2022-12-11 |S08000029 |F704H |Emergency Department |   1356|      772| 584| 168|   45|\n|2024-03-17 |S08000020 |N101H |Emergency Department |   1062|      474| 588| 279|   69|\n|2017-09-17 |S08000020 |N121H |Emergency Department |    304|      300|   4|   0|    0|\n|2021-03-07 |S08000024 |S314H |Emergency Department |   1825|     1468| 357|  39|    3|\n\n\n\n\n## Basic plots\n\n\n\n\n\n```{.r .cell-code}\nlibrary(ggplot2)\nae_activity |>\n    ggplot() +\n    geom_line(aes(x = date, y = attend, colour = hb, group = loc)) \n```\n\n![](scope_of_the_possible_with_r_files/figure-html/unnamed-chunk-12-1.png){width=672}\n\n\n\n\n## Joining data\n\n\n\n\n\n```{.r .cell-code}\nae_activity |>\n    left_join(read_csv(\"data/boards_data.csv\"), by = c(\"hb\" = \"HB\")) |>\n    select(!any_of(c(\"_id\", \"HB\", \"HBDateEnacted\", \"HBDateArchived\", \"Country\"))) |>\n    ggplot() +\n    geom_line(aes(x = date, y = attend, colour = HBName, group = loc))\n```\n\n![](scope_of_the_possible_with_r_files/figure-html/unnamed-chunk-13-1.png){width=672}\n\n\n\n\n## and again...\n\n\n\n\n\n\n\n\n\n## Add to a map\n\n\n\n\n\n```{.r .cell-code}\nae_activity_loc |>\n    leaflet::leaflet() |>\n    leaflet::addTiles() |>\n    leaflet::addMarkers(~longitude, ~latitude, label = ~HospitalName)\n```\n\n\n\n\n![](images/clipboard-4119151148.png)\n\n## Then make that map more useful\n\n\n\n\n\n```{.r .cell-code}\nae_activity_loc |>\n    group_by(HospitalName) |>\n    summarise(attend = sum(attend), n_within = sum(n_within), longitude = min(longitude), latitude = min(latitude)) |>\n    mutate(rate = paste(HospitalName, \"averages\", scales::percent(round(n_within / attend, 1)))) |>\n    leaflet::leaflet() |>\n    leaflet::addTiles() |>\n    leaflet::addMarkers(~longitude, ~latitude, label = ~rate)\n```\n\n\n\n\n\n![](images/clipboard-4119151148.png)\n\n## Then add to reports, dashboards...\n\n## Strengths\n\n-   enormous scope and flexibility\n-   a force-multiplier for fancier data work\n    -   helps collaboration within teams, between teams, between orgs\n    -   reproducible analytics\n    -   modular approaches to large projects\n-   decreasing pain curve: the fancier the project, the better\n\n## Weaknesses\n\n-   harder to learn than competitors\n-   very patchy expertise across H+SC Scotland\n-   complex IG landscape\n-   messy skills development journey\n",
    "supporting": [
      "scope_of_the_possible_with_r_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}